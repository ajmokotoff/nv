

### Abstract
Network vulnerability is a critical component of network security. Yet vulnerability analysis has received relatively little attention from the security visualization community.  

### Introduction


Rather than monitoring a network to determine if an attack is occuring, analysts
Analysts who are aware of the

Increasingly, tools such as Nessus are used to assess networks.

Nv also allows analysts to specify specific groupings and criticality scores for machines in their network. This information is then used by to affect size and other visual features in the treemap, which helps ensure that the most important machines receive the most attention.

Specifically, our contributions to the field of security visualization are as follows:

- A visualization tool that supports security vulnerability awareness, analysis, and tracking
- A framework for building web-based visualizations that do not send sensitive data to servers

In the following section, we discuss related work in vulnerability visualization and analysis. Afterwards, we discuss the design of nv. We then present several case studies involving Nessus scans from multiple systems. We conclude with a brief discussion on web-based security visualization tools and on our future plans for nv.
### Related Works in Vulnerability Analysis

Currently most computer vulnerability analysis is done using graph based
techniques to model the state of the system.  One such technique is known as
Topological Vulnerability Analysis (TVA).  TVA uses the network state and attack
vectors between machines to create an attach graph that will model all possible attack paths in a
network.  To generate these attack graphs TVA uses information from scanning
tools such as Nessus and Retina.  The graphs generated by TVA tend to be very
large so it introduces an aggregation and visual analysis element to make the
models easier to comprehend by an analyst.  One aggregation used by the TVA
visualization is to
aggregate machines based on their ability to access other machines.  A group of
machines will be aggregated if each node in the group has access to every other
node.
These groupings are then aggregated into a single node in the visualization.
**Noel**

Researchers have also used model checking tools like NuSMV to manipulate graph
representations of a network where each node is a state of the network and each
transition represents an exploit.  This type of attack graph allows and analyst
to focus efforts on patching exploits (edges) that create the largest
disconnects in the graph.  This type of analysis is convenient because we
already have graph algorithms that can efficiently perform such analysis.
**Aman**

Ou, Govindavjhala and Appel take a different approach to security analysis in
their MulVAL project.
They attempt to model the interactions between known vulnerabilities and
software bugs, configurations and permission policies.  In their approach an
analyst will specify the system and policies in a logic language that is a subset of the
Prolog logic programming language and vulnerabilities in the Open Vulnerability
Assessment Language. After the systems, policies and vulnerabilities are defined
the MulVAL system uses a two phase algorithm to simulate attacks and then policy
checking.  The system generates all possible attacks based on the
vulnerabilities and then compares those with the defined policies to detect
violations.
**Ou**

### System Design

The goal of nv is to support the sysadmin's understanding of vulnerabilities in their network by combining the results of a Nessus scan in raw format and (optionally) a list of critial machines in their network into an interactive visualization. This visualization is designed to support common workflows in vulnerability discovery, analysis, and mitigation. Some of these are described in the Case Studies sections. This section covers the visualization and interaction design.

#### Data
Nessus data in detail


#### Use Case
The primary goal of nv is to support sysadmins in identifying and analyzing vulnerabilities in their network, information which they may then use to better prioritize their (often) limited resources.
Specifically, the main questions nv seeks to answer are as follows:

- What vulnerabilities are most common across the network?
- What machines or groups have the most severe vulnerabilities?
- Are critical machines are vulnerable?

#### Visualization and Interaction
Nv consists of multiple coordinated views including a treemap, several histograms, and a detail-information area showing information on the selected Nessus id. Each of these are designed to support a specific aspect of the vulnerability analysis workflow

Our primary visualization is a zoomable treemap (TODO cite). We chose to use a treemap over other hierarchical visualization methods such as network/tree-layouts for several reasons. First, our goal with nv is to support the analysis of Nessus scans on large networks. While information on the network topology is useful for vulnerability analysis, it is important to note that in large dynamic networks, a complete network topology is often either unavailable or too large to be visualized directly. The space-filling aspects of treemaps make them more scalable in this regard. Another reason we used treemaps was for their ability to effectively make use of both size and color for encoding data attributes.

Since Nessus data is not stored in a hierarchical form by default, it could be visualized using many multi-dimensional visualization techniques, such as parallel coordinates or scatterplot matrices. However, because the scalability of the visualization was a primary concern, we opted to nest the data from individual vulnerabilities and ports up to IPs and groups of IPs. 

We also use data-accumulation and coloring methods to ensure that data is not obscured by the hierarchy. For instance, when comparing two Nessus scans, nodes are colored by the maximum count of issue states (fixed, open, or new issues) in their child nodes. A potential disadvantage of this approach is that a node could contain sligthly more fixed issues than open issues, and yet will still be colored green. To alleviate this problem, we add the option to split the nodes by issue-state higher in the hierarchy. Both options are shown in figure (TODO make figure). 

The advantage to separating issue-states higher is that the analyst can explore only the fixed issues or only the open issues. However, the disadvantage of this approach is that the IPs are then separated since they can appear in any branch of the hierarchy (fixed, open, and new). To our knowledge, there exists no widely accepted visual technique that can effectively represent multiple attributes at every level in a treemap. However, we plan to explore other common approaches such as glyphs and combined color scales in future versions of nv. 

Since analysts can specify the criticality of both individual machines and groups of machines in nv, the treemap includes sizing by criticality as an option. The most critical machines therefore appear as larger nodes, while still being colored by severity. Other sizing options include severity (the default) and by issue counts. Dual encoding severity with both color and size can be useful, as the darkest colored and largest nodes appear at the top left in each level of the histogram.

The color scales in the treemap were created using ColorBrewer2 (TODO cite). While the primary color scales shown in the paper are designed to have semantic meanings (green for fixed, red for new, orange for open), we also include a colorblind-safe version, which is shown in figure (TODO figure). 

Nv includes several histograms, including issue-type (note, hole, or open port), severity (CVSS score), top Nessus note ids, and top Nessus hole ids. These histograms serve dual purposes, as both overviews of the data and as filters by which sysadmins may guide their analysis. For instance, by brushing over the highest values in the severity histogram, the appropriate nodes in the treemap are highlighted. This works by examining each child of each element in the current level of the hierarchy. Another use of the histograms is to easily highlight the most commonly occuring issues in the network. A possible drawback of this approach is that sometimes the least common issues can be the most damaging. However, this issue is mitigated by the fact that the treemap can be be sized and colored by severity, which makes the most damaging issues easy to find. The histograms also operate in as conjunction (AND), meaning that the sysadmin can specify queries such as all issues of type hole with severity of 5 or greater.

The Nessus information area is updated when the sysadmin drills down to the level at which Nessus issue-identification numbers are shown. The area then updates with detailed information about the currently selected Nessus id, including a synopsis, detailed description, vulnerability family, and solution (when available). Based on this information, the sysadmin has the option to mark the vulnerability as either fixed or as a non-issue, which re-colors the node in the treemap. This functionality is intended to serve as a way for analysts to avoid revisiting issues that have been addressed. 

#### Implementation
Nv is implemented in Javascript. The d3.js toolkit is used as the basis for the visualizations and interaction. Crossfilter.js, an in-memory data structure for Javascript, is used to manage datasets in an efficient manner. Finally, the Nessus to JSON parsing and change-detection was developed for nv. (TODO citations for these libs).

One crucial feature of nv is that everything was designed to avoid sending sensitive Nessus scans to servers. Our implementation therefore runs completely in the browser.
## Use Cases and Work Flow

We envision our system being useful for two types of use cases.  The first is
analyzing the current vulnerabilities associated with machines on a network.
This use case is to allow a system administrator to prioritize maintenance based
on the value of the machines and the criticality of the vulnerabilities found on
those machines using data from Nessus scans.  The second use case is visualizing 
the changes to the vulnerability states of machines on a network after a system
administrator performs maintenance.


### Dynamic Vulnerability State Network

The first use case for our system is to make it easier for administrators to
visualize that state of machines on a network before and after maintenance. 
The grouping functionality allows
the administrator to group together related machines by subnet, purpose of
functionality.  In this example virtual system machines are grouped into three
different categories.  One group is a set of twenty-two workstations split
between ten Fedora workstations and twelve Ubuntu workstations.  The second group is
a set of five servers that serve the Wordpress blogging software.  The last
grouping is a set of five Linux Apache PostgreSQL PHP (LAPP) servers.
Initially all of these groupings contain serious vulnerabilities.
The LAPP servers are running a poorly configured file transfer protocol (FTP) server
and both the LAPP and Wordpress servers both have very simple root passwords
which Nessus shows as a security hole.  The majority of the workstations are properly configured
save for two that contain multiple security holes.  Both of these workstations are
running outdated versions of the Ubuntu operating system and have
vulnerabilities such as an FTP server that allows a remote user to execute
arbitrary code, an incorrectly configured Windows file sharing software, weak secure shell
(SSH) keys and a Samba server that is vulnerable to buffer overflow attacks.

**Screen shot of group level (criticality) should go around here.**
![Alt Text](screenshots/final/SimGroupSingle.png)

While in the criticality visualization mode the administrators attention is
drawn to the very large LAPP server node.  The size is an indication of the
importance of the situation based on the number of security holes discovered,
the severity of the security holes discovered and the assigned criticality of
the machines in the group.  When the administrator zooms into the LAPP Server
node of the treemap he sees that all five of the machines seem to be equally
at risk.  To gain further insight the administrator zooms into the node for a
specific machine where each node represent a port with an associated
vulnerability.  At the specific port node the administrator can click on a
vulnerability ID and the tool will display information about the vulnerability
and potential solutions in the right panel.  In this situation the LAPP servers all have the same
weak root password security hole.  The system administrator will also find that
the Wordpress servers suffer from the same weak password vulnerability as the
LAPP servers.

**Screenshot of zoomed in tree map can go here.**
![Alt Text](screenshots/final/LAPPServerSimPort.png)

When the administrator zooms back out to the
group view and switches the visualization to severity mode the workstations'
node grows, bringing it into greater prominence.  When the administrator
zooms into the workstation group he can see that two IP addresses have much
larger and darker node than any of the other workstations.  If he zooms into
one of these IP addresses he sees that the most severe of the vulnerabilities
are associated with ports 445 and 80.  The administrator can examine each port
nodes' child and see information about the specific vulnerabilities in the right
panel and see that the machine is running a poorly configured Apache
Web Server and a Windows share that can be accessed through the network.

After further exploring his network the administrator patches the most critical
vulnerabilities in his system.  The Nessus Vulnerability Visualization system
provides functionality to compare two nbe files to show changes between two
vulnerability states such as before and after applying patches.  After patching
his system the administrator can rescan his network then explore and see the
differences between the previous state and his newly patched system.
The Nessus Visualization System shows corrected
vulnerabilities in green, the remaining vulnerabilities in orange and any new
vulnerabilities in pink.  The system administrator can easily see that the
major workstations vulnerabilities have been patched.  Zooming into the
workstation node the system administrator sees that while he patched the most
severe vulnerabilities he inadvertently opens new vulnerabilities on the two
machines and did not address some of the vulnerabilities seen earlier.

**Screenshot of diff treemap.**
![Alt Text](screenshots/final/SimDiffGroup.png)

We simulated this use case using virtual machines (VM) communicating through a host only
network. Using a host only network allowed us to use Nessus from the host
to scan the VMs.  We used one grouping of two different types of work station
and two groupings of similar servers. Both of the groups of servers were using Ubuntu 10.10 LTS.
Ten of the Ubuntu workstations were using Ubuntu 11.10 while the two workstations
with the massive number of vulnerabilities were using Ubuntu 8.04 with
purposely unpatched and misconfigured software.
The Fedora workstations were running Fedora 15.  We used the Metasploitable
virtual machine image to simulate the two vulnerable workstations before they
were upgraded to 11.10.

In this use case we did not patch all security notes that Nessus mentions
because this would not be realistic for an actual system administrator.  Instead
the system administrator would handle the most important vulnerabilities and
system updates.  In this simulated use case we improved the weak root passwords
and corrected the poorly configured FTP server seen on the servers.  We focused on updating
and correcting the two most vulnerable workstations by updating them to be the
same as the other ten Ubuntu workstations.

### Static Vulnerability State Network

To test visualizing a large static vulnerability state we use Nessus scan data from
the VAST Challenge 2011. This data is from a simulated network for the
fictitious All Freight Corporation.  The VAST challenge gives us a large network
dataset to test how the Nessus Vulnerability Visualization scales to a large
data set that contains many vulnerabilities spread across different machines and
groups.  This data set has more than one
hundred fifty unique IP addresses associated with various workstations in the
scan.  The Nessus scan shows that numerous
machines on the network have some sort of security hole such as incorrectly
configured telnet client, a font driver that allows privilege escalation and a
vulnerability in an outdated version of Microsoft Excel.  The All Freight
Corporation has other machines and servers but they were not included in the
Nessus scan data.

** Screenshot of over all **
![Alt Text](screenshots/final/VastGroup.png)

We split the workstations into six groups with criticalities ranging from two to
nine.  The major security holes in the group are concentrated in group four with a
criticality of nine and in group five with a criticality of two.  When the
system administrator looks at the groups level on the tree map it is immediately
obvious where his attention is needed most.  Groups four and five dominate the
treemap in all three visualization modes.  When the system administrator zooms
into group four he sees that most of the vulnerabilities are locate on two IP
addresses.  When he selects IP address 192.168.2.172 he sees that nearly all of
the vulnerabilities are associated with port 445 and a Windows file sharing
program.  He can also explore the other dominate IP address 192.168.2.171 and
see that this machines vulnerabilities come from port 139 and NetBIOS.  The
Nessus Vulnerability Visualization system makes the most critical and most
severe vulnerabilities most prominent in the visualization This
exploration allows the system administrator to easily discover vulnerabilities
in his system and prioritize repair.  It also makes it easier to view large
networks because groups of IP addresses are aggregated in the tree and then the
IP addresses themselves can also be aggregated into treemap nodes.  

** Screen Shot of a zoomed in node **
![Alt Text](screenshots/final/VASTWorkstationPort.png)

### Conclusion

